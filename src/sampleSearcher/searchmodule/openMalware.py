from yapsy.IPlugin import IPlugin

#require Google Authentication!!!
class OpenMalware(IPlugin):
    
    downloadURLs = []
    
    # Benoetigt ein Triple: [sha256,sha1,md5]
    def searchSample(self, hashes):
        sha256,sha1,md5 = hashes
        print "Search for Sample: %s; %s; %s" % (sha256,sha1,md5)
        self.downloadURLs.append("http://oc.gtisc.gatech.edu:8080/download.cgi?id=730898217&auth=02d5a1243406e2ce75e119e3e47b86edb8276bc2474ebab5c20d4853489ebd36")
        return True
        
    def isDownloadable(self):
        return False
        
    def downloadSample(self):
        pass
    
    def getDownloadURLs(self):
        if self.downloadURLs:
            return self.downloadURLs
        else:
            raise Exception("Keine Download-URL vorhanden!") 
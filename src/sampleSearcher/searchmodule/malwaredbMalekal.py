__description__ = 'Download Sample from MalwaredbMalekal Repo http://malwaredb.malekal.com/'
__author__ = 'Robby Zeitfuchs'
__version__ = '0.0.1'
__date__ = '2015/11/13'

class MalwaredbMalekal():

    downloadURLs = []
    
    def searchSample(self, sha256, sha1, md5):
        print "MalwaredbMalekal search for Sample: %s; %s; %s" % (sha256,sha1,md5)
        
        #self.downloadURLs.append("http://malwaredb.malekal.com/files.php?file=119fc18d787e2559ee400070fe325912")
        return True
        
    def isDownloadable(self):
        if self.downloadURLs:
            return True
        return False
        
    def downloadSample(self, path):
        if not self.downloadURLs:
            raise Exception("Keine Download-URL vorhanden!") 
        
        #einzelne URLs testen und versuchen das Sample zu laden
        for downloadURL in self.downloadURLs:
            print downloadURL
            
        #Datei entpacken (zip)
            
        #sollte das Laden erfolgreich sein -> Hash checken
    
    def getDownloadURLs(self):
        if self.downloadURLs:
            return self.downloadURLs
        else:
            raise Exception("Keine Download-URL vorhanden!") 
        
AddPlugin(MalwaredbMalekal)
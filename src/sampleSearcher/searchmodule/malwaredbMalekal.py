from yapsy.IPlugin import IPlugin

class MalwaredbMalekal(IPlugin):

    downloadURLs = []
    
    # Benoetigt ein Triple: [sha256,sha1,md5]
    def searchSample(self, hashes):
        sha256,sha1,md5 = hashes
        print "Search for Sample: %s; %s; %s" % (sha256,sha1,md5)
        
        self.downloadURLs.append("http://malwaredb.malekal.com/files.php?file=119fc18d787e2559ee400070fe325912")
        return True
        
    def isDownloadable(self):
        if self.downloadURLs:
            return True
        return False
        
    def downloadSample(self, path):
        if not self.downloadURLs:
            raise Exception("Keine Download-URL vorhanden!") 
        
        #einzelne URLs testen und versuchen das Sample zu laden
        for downloadURL in self.downloadURLs:
            print downloadURL
            
        #Datei entpacken (zip)
            
        #sollte das Laden erfolgreich sein -> Hash checken
    
    def getDownloadURLs(self):
        if self.downloadURLs:
            return self.downloadURLs
        else:
            raise Exception("Keine Download-URL vorhanden!") 